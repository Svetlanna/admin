jQuery(document).ready(function(a){"use strict";var b={startX:0,startY:0,endX:0,endY:0,option:{tableLanguage:WPGlobusCoreData.language},selector:['<div class="wpglobus-selector">','<span class="language">{{language}}</span>','<div class="wpglobus-language-box">',"<ul>","{{language_list}}","</ul>","</div>","</div>"].join(""),init:function(c){b.option=a.extend(b.option,c),"tablepress-all-tables"==WPGlobusPlusTablePress.action?b.setAllTables():(b.addSelector(),b.setTable(!0),b.addElements(),b.addListeners())},setAllTables:function(){var b=[".tablepress-all-tables .column-table_name a",".tablepress-all-tables .column-table_description"];a(b).each(function(b,c){a(c).each(function(b,c){var d=a(this);d.text(WPGlobusCore.TextFilter(d.text(),WPGlobusCoreData.language))})})},setMenuItems:function(){a(".wpglobus-selector .language").text(WPGlobusCoreData.en_language_name[b.option.tableLanguage]),a(".wpglobus-language-box ul").html(b.getMenuItems()),b.addMenuListeners()},getMenuItems:function(){var c="";return a.each(WPGlobusCoreData.enabled_languages,function(a,d){d!=b.option.tableLanguage&&(c+='<li><a href="" onclick="return false;" class="item" data-language="'+d+'">'+WPGlobusCoreData.en_language_name[d]+"</a></li>")}),c},addSelector:function(){b.selector=b.selector.replace("{{language}}",WPGlobusCoreData.en_language_name[WPGlobusCoreData.language]),b.selector=b.selector.replace("{{language_list}}",b.getMenuItems),a("#tablepress_edit-table-data .handlediv").before(b.selector)},setTable:function(c){a("#edit-form-body textarea").each(function(d,e){var f,g=a(this);c?(f=g.val(),g.attr("data-wpglobus-source",f)):f=g.data("wpglobus-source"),g.val(WPGlobusCore.TextFilter(f,b.option.tableLanguage,"RETURN_EMPTY"))})},addTableListeners:function(){a("#edit-form-body textarea").each(function(c,d){var e=a(this);e.off("change"),e.on("change",function(c){var d=a(this);d.data("wpglobus-source",WPGlobusCore.getString(d.data("wpglobus-source"),d.val(),b.option.tableLanguage))})})},addAppendListeners:function(){var c=["#rows-append","#columns-append","#rows-duplicate","#columns-duplicate","#rows-insert","#columns-insert"].join(",");a(c).on("click",function(c){a("#edit-form-body textarea").each(function(b,c){var d=a(this);void 0==d.data("wpglobus-source")&&d.attr("data-wpglobus-source","")}),b.addTableListeners()})},addListeners:function(){b.addTableListeners(),a(".save-changes-button").on("mouseenter",function(c){a("#edit-form-body textarea").each(function(b,c){var d=a(this);"undefined"!=d.data("wpglobus-source")&&d.val(d.data("wpglobus-source"))});var d=a(this);b.startX=d.offset().left,b.startY=d.offset().top,b.endX=b.startX+d.width(),b.endY=b.startY+d.height()}).on("mouseleave",function(a){b.setTable(!1)}),a(document).ajaxComplete(function(c,d,e){e.data.indexOf("action=tablepress_save_table&")>=0&&a(document).one("mousemove",function(a){(a.pageX<b.startX-5||a.pageX>b.endX+20||a.pageY<b.startY||a.pageY>b.endY+5)&&b.setTable(!1)})}),a(".wpglobus-selector").on("mouseenter",function(b){a(".wpglobus-language-box").css({display:"block"})}).on("mouseleave",function(b){a(".wpglobus-language-box").css({display:"none"})}),b.addMenuListeners(),b.addAppendListeners()},addMenuListeners:function(){a(".wpglobus-selector .item").on("click",function(c){a(".wpglobus-language-box").css({display:"none"}),b.option.tableLanguage=a(this).data("language"),b.setTable(!1),b.setMenuItems()})},addElements:function(){WPGlobusDialogApp.addElement({id:"table-name",dialogTitle:"Edit Table name",sbTitle:"Click for edit",style:"width:95%;float:left;"}),WPGlobusDialogApp.addElement({id:"table-description",dialogTitle:"Edit Table description",sbTitle:"Click for edit"})}};WPGlobusPlusTablePress=a.extend({},WPGlobusPlusTablePress,b),WPGlobusPlusTablePress.init()});